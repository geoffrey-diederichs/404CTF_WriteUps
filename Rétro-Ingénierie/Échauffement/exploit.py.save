from pwn import *

def find_password(x: str) -> str:
    password = []
    for i in range(len(secret)):
        password.append(chr(int((int(secret[i], 16)+i)/2)))
    return password
    
secret = ['68', '5f', '66', '83', 'a4', '87', 'f0', 'd1', 'b6', 'c1', 'bc', 'c5', '5c', 'dd', 'be', 'bd', '56', 'c9', '54', 'c9', 'd4', 'a9', '50', 'cf', 'd0', 'a5', 'ce', '4b', 'c8', 'bd', '44', 'bd', 'aa', 'd9', '00', '00', '00', '00', '00', '00']
password = "".join(find_password(secret))

payload = b"".join([
    password.encode(),
    b"\n",
])

p = process("./echauffement.bin")
p.send(payload)
p.interactive()

print("Flag : ", password)
